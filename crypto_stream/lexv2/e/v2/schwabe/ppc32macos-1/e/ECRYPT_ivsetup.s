.text
.align 3
.globl _ECRYPT_ivsetup_qhasm
.globl ECRYPT_ivsetup_qhasm
_ECRYPT_ivsetup_qhasm:
ECRYPT_ivsetup_qhasm:
stwu r1,-384(r1)
stw r13,0(r1)
stw r14,4(r1)
stw r15,8(r1)
stw r16,12(r1)
stw r17,16(r1)
stw r18,20(r1)
stw r19,24(r1)
stw r20,28(r1)
stw r21,32(r1)
stw r22,36(r1)
stw r23,40(r1)
stw r24,44(r1)
stw r25,48(r1)
stw r26,52(r1)
stw r27,56(r1)
stw r28,60(r1)
stw r29,64(r1)
stw r30,68(r1)
lis r5,hi16(_aes_big_constants)
ori r5,r5,lo16(_aes_big_constants)
mr r6,r5
addi r6,r6,40
mr r7,r5
addi r7,r7,48
mr r8,r5
addi r8,r8,44
mr r5,r5
addi r5,r5,52
lwz r9,0(r3)
lwz r10,4(r3)
lwz r11,8(r3)
lwz r12,12(r3)
stw r9,72(r1)
stw r10,76(r1)
stw r11,80(r1)
stw r12,84(r1)
lwz r9,16(r3)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,88(r1)
lwz r9,20(r3)
stw r10,92(r1)
stw r11,96(r1)
stw r12,100(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,104(r1)
lwz r9,24(r3)
stw r10,108(r1)
stw r11,112(r1)
stw r12,116(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,120(r1)
lwz r9,28(r3)
stw r10,124(r1)
stw r11,128(r1)
stw r12,132(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,136(r1)
lwz r9,32(r3)
stw r10,140(r1)
stw r11,144(r1)
stw r12,148(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,152(r1)
lwz r9,36(r3)
stw r10,156(r1)
stw r11,160(r1)
stw r12,164(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,168(r1)
lwz r9,40(r3)
stw r10,172(r1)
stw r11,176(r1)
stw r12,180(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,184(r1)
lwz r9,44(r3)
stw r10,188(r1)
stw r11,192(r1)
stw r12,196(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,200(r1)
lwz r9,48(r3)
stw r10,204(r1)
stw r11,208(r1)
stw r12,212(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,216(r1)
lwz r9,52(r3)
stw r10,220(r1)
stw r11,224(r1)
stw r12,228(r1)
xor r10,r9,r10
xor r11,r10,r11
xor r12,r11,r12
stw r9,232(r1)
stw r10,236(r1)
stw r11,240(r1)
stw r12,244(r1)
lwbrx r9,0,r4
addi r4,r4,4
lwbrx r10,0,r4
addi r4,r4,4
lwbrx r11,0,r4
addi r4,r4,4
lwbrx r4,0,r4
lwz r12,72(r1)
lwz r13,76(r1)
lwz r14,80(r1)
lwz r15,84(r1)
xor r9,r12,r9
xor r10,r13,r10
xor r11,r14,r11
xor r4,r15,r4
lwz r12,88(r1)
rlwinm r13,r9,12,4080
lwz r14,92(r1)
rlwinm r15,r9,20,4080
lwz r16,96(r1)
rlwinm r17,r9,28,4080
lwz r18,100(r1)
rlwinm r9,r9,4,4080
lwzx r13,r6,r13
rlwinm r19,r10,12,4080
lwzx r15,r7,r15
rlwinm r20,r10,20,4080
lwzx r17,r8,r17
rlwinm r21,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r9,r9,r14
lwzx r14,r6,r19
rlwinm r16,r11,12,4080
lwzx r17,r7,r20
rlwinm r18,r11,20,4080
lwzx r19,r8,r21
rlwinm r20,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
xor r9,r14,r9
xor r12,r17,r12
xor r13,r19,r13
xor r10,r10,r15
lwzx r14,r6,r16
rlwinm r15,r4,12,4080
lwzx r16,r7,r18
rlwinm r17,r4,20,4080
lwzx r18,r8,r20
rlwinm r19,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
lwzx r15,r6,r15
xor r10,r14,r10
lwzx r14,r7,r17
xor r9,r16,r9
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r4,r5,r4
xor r11,r11,r13
xor r10,r10,r14
xor r9,r9,r16
xor r4,r12,r4
xor r11,r11,r15
lwz r12,104(r1)
rlwinm r13,r4,12,4080
lwz r14,108(r1)
rlwinm r15,r4,20,4080
lwz r16,112(r1)
rlwinm r17,r4,28,4080
lwz r18,116(r1)
rlwinm r4,r4,4,4080
lwzx r13,r6,r13
rlwinm r19,r9,12,4080
lwzx r15,r7,r15
rlwinm r20,r9,20,4080
lwzx r17,r8,r17
rlwinm r21,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r4,r4,r14
lwzx r14,r6,r19
rlwinm r16,r10,12,4080
lwzx r17,r7,r20
rlwinm r18,r10,20,4080
lwzx r19,r8,r21
rlwinm r20,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
xor r4,r14,r4
xor r12,r17,r12
xor r13,r19,r13
xor r9,r9,r15
lwzx r14,r6,r16
rlwinm r15,r11,12,4080
lwzx r16,r7,r18
rlwinm r17,r11,20,4080
lwzx r18,r8,r20
rlwinm r19,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
lwzx r15,r6,r15
xor r9,r14,r9
lwzx r14,r7,r17
xor r4,r16,r4
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r11,r5,r11
xor r10,r10,r13
xor r9,r9,r14
xor r4,r4,r16
xor r11,r12,r11
xor r10,r10,r15
lwz r12,120(r1)
rlwinm r13,r11,12,4080
lwz r14,124(r1)
rlwinm r15,r11,20,4080
lwz r16,128(r1)
rlwinm r17,r11,28,4080
lwz r18,132(r1)
rlwinm r11,r11,4,4080
lwzx r13,r6,r13
rlwinm r19,r4,12,4080
lwzx r15,r7,r15
rlwinm r20,r4,20,4080
lwzx r17,r8,r17
rlwinm r21,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r11,r11,r14
lwzx r14,r6,r19
rlwinm r16,r9,12,4080
lwzx r17,r7,r20
rlwinm r18,r9,20,4080
lwzx r19,r8,r21
rlwinm r20,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
xor r11,r14,r11
xor r12,r17,r12
xor r13,r19,r13
xor r4,r4,r15
lwzx r14,r6,r16
rlwinm r15,r10,12,4080
lwzx r16,r7,r18
rlwinm r17,r10,20,4080
lwzx r18,r8,r20
rlwinm r19,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
lwzx r15,r6,r15
xor r4,r14,r4
lwzx r14,r7,r17
xor r11,r16,r11
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r10,r5,r10
xor r9,r9,r13
xor r4,r4,r14
xor r11,r11,r16
xor r10,r12,r10
xor r9,r9,r15
lwz r12,136(r1)
rlwinm r13,r10,12,4080
lwz r14,140(r1)
rlwinm r15,r10,20,4080
lwz r16,144(r1)
rlwinm r17,r10,28,4080
lwz r18,148(r1)
rlwinm r10,r10,4,4080
lwzx r13,r6,r13
rlwinm r19,r11,12,4080
lwzx r15,r7,r15
rlwinm r20,r11,20,4080
lwzx r17,r8,r17
rlwinm r21,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r10,r10,r14
lwzx r14,r6,r19
rlwinm r16,r4,12,4080
lwzx r17,r7,r20
rlwinm r18,r4,20,4080
lwzx r19,r8,r21
rlwinm r20,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
xor r10,r14,r10
xor r12,r17,r12
xor r13,r19,r13
xor r11,r11,r15
lwzx r14,r6,r16
rlwinm r15,r9,12,4080
lwzx r16,r7,r18
rlwinm r17,r9,20,4080
lwzx r18,r8,r20
rlwinm r19,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
lwzx r15,r6,r15
xor r11,r14,r11
lwzx r14,r7,r17
xor r10,r16,r10
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r9,r5,r9
xor r4,r4,r13
xor r11,r11,r14
xor r10,r10,r16
xor r9,r12,r9
xor r4,r4,r15
lwz r12,152(r1)
rlwinm r13,r9,12,4080
lwz r14,156(r1)
rlwinm r15,r9,20,4080
lwz r16,160(r1)
rlwinm r17,r9,28,4080
lwz r18,164(r1)
rlwinm r9,r9,4,4080
lwzx r13,r6,r13
rlwinm r19,r10,12,4080
lwzx r15,r7,r15
rlwinm r20,r10,20,4080
lwzx r17,r8,r17
rlwinm r21,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r9,r9,r14
lwzx r14,r6,r19
rlwinm r16,r11,12,4080
lwzx r17,r7,r20
rlwinm r18,r11,20,4080
lwzx r19,r8,r21
rlwinm r20,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
xor r9,r14,r9
xor r12,r17,r12
xor r13,r19,r13
xor r10,r10,r15
lwzx r14,r6,r16
rlwinm r15,r4,12,4080
lwzx r16,r7,r18
rlwinm r17,r4,20,4080
lwzx r18,r8,r20
rlwinm r19,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
lwzx r15,r6,r15
xor r10,r14,r10
lwzx r14,r7,r17
xor r9,r16,r9
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r4,r5,r4
xor r11,r11,r13
xor r10,r10,r14
xor r9,r9,r16
xor r4,r12,r4
xor r11,r11,r15
lwz r12,168(r1)
rlwinm r13,r4,12,4080
lwz r14,172(r1)
rlwinm r15,r4,20,4080
lwz r16,176(r1)
rlwinm r17,r4,28,4080
lwz r18,180(r1)
rlwinm r4,r4,4,4080
lwzx r13,r6,r13
rlwinm r19,r9,12,4080
lwzx r15,r7,r15
rlwinm r20,r9,20,4080
lwzx r17,r8,r17
rlwinm r21,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r4,r4,r14
lwzx r14,r6,r19
rlwinm r16,r10,12,4080
lwzx r17,r7,r20
rlwinm r18,r10,20,4080
lwzx r19,r8,r21
rlwinm r20,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
xor r4,r14,r4
xor r12,r17,r12
xor r13,r19,r13
xor r9,r9,r15
lwzx r14,r6,r16
rlwinm r15,r11,12,4080
lwzx r16,r7,r18
rlwinm r17,r11,20,4080
lwzx r18,r8,r20
rlwinm r19,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
lwzx r15,r6,r15
xor r9,r14,r9
lwzx r14,r7,r17
xor r4,r16,r4
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r11,r5,r11
xor r10,r10,r13
xor r9,r9,r14
xor r4,r4,r16
xor r11,r12,r11
xor r10,r10,r15
lwz r12,184(r1)
rlwinm r13,r11,12,4080
lwz r14,188(r1)
rlwinm r15,r11,20,4080
lwz r16,192(r1)
rlwinm r17,r11,28,4080
lwz r18,196(r1)
rlwinm r11,r11,4,4080
lwzx r13,r6,r13
rlwinm r19,r4,12,4080
lwzx r15,r7,r15
rlwinm r20,r4,20,4080
lwzx r17,r8,r17
rlwinm r21,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r11,r11,r14
lwzx r14,r6,r19
rlwinm r16,r9,12,4080
lwzx r17,r7,r20
rlwinm r18,r9,20,4080
lwzx r19,r8,r21
rlwinm r20,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
xor r11,r14,r11
xor r12,r17,r12
xor r13,r19,r13
xor r4,r4,r15
lwzx r14,r6,r16
rlwinm r15,r10,12,4080
lwzx r16,r7,r18
rlwinm r17,r10,20,4080
lwzx r18,r8,r20
rlwinm r19,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
lwzx r15,r6,r15
xor r4,r14,r4
lwzx r14,r7,r17
xor r11,r16,r11
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r10,r5,r10
xor r9,r9,r13
xor r4,r4,r14
xor r11,r11,r16
xor r10,r12,r10
xor r9,r9,r15
lwz r12,200(r1)
rlwinm r13,r10,12,4080
lwz r14,204(r1)
rlwinm r15,r10,20,4080
lwz r16,208(r1)
rlwinm r17,r10,28,4080
lwz r18,212(r1)
rlwinm r10,r10,4,4080
lwzx r13,r6,r13
rlwinm r19,r11,12,4080
lwzx r15,r7,r15
rlwinm r20,r11,20,4080
lwzx r17,r8,r17
rlwinm r21,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r10,r10,r14
lwzx r14,r6,r19
rlwinm r16,r4,12,4080
lwzx r17,r7,r20
rlwinm r18,r4,20,4080
lwzx r19,r8,r21
rlwinm r20,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
xor r10,r14,r10
xor r12,r17,r12
xor r13,r19,r13
xor r11,r11,r15
lwzx r14,r6,r16
rlwinm r15,r9,12,4080
lwzx r16,r7,r18
rlwinm r17,r9,20,4080
lwzx r18,r8,r20
rlwinm r19,r9,28,4080
lwzx r4,r5,r4
rlwinm r9,r9,4,4080
lwzx r15,r6,r15
xor r11,r14,r11
lwzx r14,r7,r17
xor r10,r16,r10
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r9,r5,r9
xor r4,r4,r13
xor r11,r11,r14
xor r10,r10,r16
xor r9,r12,r9
xor r4,r4,r15
lwz r12,216(r1)
rlwinm r13,r9,12,4080
lwz r14,220(r1)
rlwinm r15,r9,20,4080
lwz r16,224(r1)
rlwinm r17,r9,28,4080
lwz r18,228(r1)
rlwinm r9,r9,4,4080
lwzx r13,r6,r13
rlwinm r19,r10,12,4080
lwzx r15,r7,r15
rlwinm r20,r10,20,4080
lwzx r17,r8,r17
rlwinm r21,r10,28,4080
lwzx r9,r5,r9
rlwinm r10,r10,4,4080
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r9,r9,r14
lwzx r14,r6,r19
rlwinm r16,r11,12,4080
lwzx r17,r7,r20
rlwinm r18,r11,20,4080
lwzx r19,r8,r21
rlwinm r20,r11,28,4080
lwzx r10,r5,r10
rlwinm r11,r11,4,4080
xor r9,r14,r9
xor r12,r17,r12
xor r13,r19,r13
xor r10,r10,r15
lwzx r14,r6,r16
rlwinm r15,r4,12,4080
lwzx r16,r7,r18
rlwinm r17,r4,20,4080
lwzx r18,r8,r20
rlwinm r19,r4,28,4080
lwzx r11,r5,r11
rlwinm r4,r4,4,4080
lwzx r15,r6,r15
xor r10,r14,r10
lwzx r14,r7,r17
xor r9,r16,r9
lwzx r16,r8,r19
xor r12,r18,r12
lwzx r4,r5,r4
xor r11,r11,r13
xor r10,r10,r14
xor r9,r9,r16
xor r4,r12,r4
xor r11,r11,r15
lwz r12,232(r1)
rlwinm r13,r4,12,4080
lwz r14,236(r1)
rlwinm r15,r4,20,4080
lwz r16,240(r1)
rlwinm r17,r4,28,4080
lwz r18,244(r1)
rlwinm r4,r4,4,4080
lwzx r13,r8,r13
rlwinm r19,r9,12,4080
lwzx r15,r5,r15
rlwinm r20,r9,20,4080
lwzx r17,r6,r17
rlwinm r21,r9,28,4080
lwzx r4,r7,r4
rlwinm r9,r9,4,4080
andis. r13,r13,0xff00
andis. r15,r15,0xff
andi. r17,r17,0xff00
andi. r4,r4,0xff
xor r12,r13,r12
xor r13,r15,r18
xor r15,r17,r16
xor r4,r4,r14
lwzx r14,r8,r19
rlwinm r16,r10,12,4080
lwzx r17,r5,r20
rlwinm r18,r10,20,4080
lwzx r19,r6,r21
rlwinm r20,r10,28,4080
lwzx r9,r7,r9
rlwinm r10,r10,4,4080
andis. r14,r14,0xff00
andis. r17,r17,0xff
andi. r19,r19,0xff00
andi. r9,r9,0xff
xor r4,r14,r4
xor r12,r17,r12
xor r13,r19,r13
xor r9,r9,r15
lwzx r14,r8,r16
rlwinm r15,r11,12,4080
lwzx r16,r5,r18
rlwinm r17,r11,20,4080
lwzx r18,r6,r20
rlwinm r19,r11,28,4080
lwzx r10,r7,r10
rlwinm r11,r11,4,4080
andis. r14,r14,0xff00
andis. r16,r16,0xff
andi. r18,r18,0xff00
andi. r10,r10,0xff
lwzx r8,r8,r15
xor r9,r14,r9
lwzx r5,r5,r17
xor r4,r16,r4
lwzx r6,r6,r19
xor r12,r18,r12
lwzx r7,r7,r11
xor r10,r10,r13
andis. r8,r8,0xff00
andis. r5,r5,0xff
andi. r6,r6,0xff00
andi. r7,r7,0xff
xor r7,r12,r7
xor r4,r4,r6
xor r5,r9,r5
xor r6,r10,r8
stw r7,56(r3)
stw r4,60(r3)
stw r5,64(r3)
stw r6,68(r3)
lwz r13,0(r1)
lwz r14,4(r1)
lwz r15,8(r1)
lwz r16,12(r1)
lwz r17,16(r1)
lwz r18,20(r1)
lwz r19,24(r1)
lwz r20,28(r1)
lwz r21,32(r1)
lwz r22,36(r1)
lwz r23,40(r1)
lwz r24,44(r1)
lwz r25,48(r1)
lwz r26,52(r1)
lwz r27,56(r1)
lwz r28,60(r1)
lwz r29,64(r1)
lwz r30,68(r1)
addi r1,r1,384
blr
